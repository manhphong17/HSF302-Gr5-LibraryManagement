<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head><meta charset="UTF-8"><title>Borrow/Return</title></head>
<body>

<!-- ===== Fragment: Form MƯỢN ===== -->
<div th:fragment="borrowForm">
    <form th:action="@{/librarian/borrow}" method="post" class="row g-3">
        <div th:with="csrf=${#request.getAttribute('_csrf')}" th:if="${csrf != null}">
            <input type="hidden" th:name="${csrf.parameterName}" th:value="${csrf.token}"/>
        </div>

        <div class="col-md-6">
            <label class="form-label">Mã độc giả (studentCode) *</label>
            <input class="form-control" name="studentCode"
                   th:value="${borrowDTO != null} ? ${borrowDTO.studentCode} : ''" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Mã bản sao sách (BookItem ID) *</label>
            <input class="form-control" name="bookItemId" type="number" min="1"
                   th:value="${borrowDTO != null} ? ${borrowDTO.bookItemId} : ''" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Thủ thư xử lý (ID) *</label>
            <input class="form-control" name="librarianId" type="number" min="1"
                   th:value="${borrowDTO != null} ? ${borrowDTO.librarianId} : ''" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Ngày đến hạn (optional)</label>
            <input class="form-control" name="dueDate" type="date"
                   th:value="${borrowDTO != null} ? ${borrowDTO.dueDate} : ''">
        </div>

        <div class="col-12">
            <button class="btn btn-success" type="submit">Xác nhận mượn</button>
        </div>
    </form>
</div>

<!-- ===== Fragment: Form TRẢ ===== -->
<div th:fragment="returnForm">
    <form th:action="@{/librarian/return}" method="post" class="row g-3">
        <div th:with="csrf=${#request.getAttribute('_csrf')}" th:if="${csrf != null}">
            <input type="hidden" th:name="${csrf.parameterName}" th:value="${csrf.token}"/>
        </div>

        <div class="col-md-6">
            <label class="form-label">Mã phiếu mượn *</label>
            <input class="form-control" name="recordId" type="number" min="1"
                   th:value="${returnDTO != null} ? ${returnDTO.recordId} : ''" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Thủ thư xử lý (ID) *</label>
            <input class="form-control" name="librarianId" type="number" min="1"
                   th:value="${returnDTO != null} ? ${returnDTO.librarianId} : ''" required>
        </div>

        <div class="col-12">
            <button class="btn btn-primary" type="submit">Xác nhận trả</button>
        </div>
    </form>
</div>

</body>
</html>
